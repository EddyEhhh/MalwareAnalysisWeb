<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xml:lang="en">

    <ui:composition template="/template/user_default.xhtml">
        <ui:define name="pageTitle">#{msg["header.report"]}</ui:define>
        <ui:define name="body">
            <h:body>
                <h:form class="px-5 pt-5" id="selectedReport">
                    <p:link value="#{msg['report.goBack']}" outcome="/page/user/report.xhtml">
                    </p:link>
                    <br/>
                    <div class="line-height-3">
                        <div>
                            <div class="text-lg grid">
                                <div class="col-10">
                                    <h:outputText class="text-3xl font-bold" value="#{reportBean.selectedSample.reportValueDTO.sampleName}"/> <br/><br/>
                                    <p:tag class="text-lg w-1" severity="#{reportBean.threatLevelSeverity}" value="#{reportBean.selectedSample.reportValueDTO.designation.toUpperCase()}" ></p:tag> <br/><br/>
                                    <b>#{msg['report.analysisStartTime']}</b><br/><h:outputText value="#{reportBean.selectedSample.timestamp}"/> <br/><br/>
                                    <b>#{msg['report.analysisEnvironment']}</b><br/><h:outputText value="#{reportBean.selectedSample.analysisEnvironment}"/>
                                    <br/>    
                                </div>
                                <div class="col-2">     
                                    <div class="knob-container  ui-corner-all">
                                        <p:knob max="5" backgroundColor="#495057" disabled="true" foregroundColor="#{reportBean.color}" value="#{reportBean.selectedSample.reportValueDTO.threatScore}"/>
                                        <!--                                        colorTheme="hot-sneaks"-->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <p:divider/>
                    <h5>#{msg['report.fileProperties']}</h5>
                    <div class="line-height-3 text-lg">
                        <table width="100%" class="text-left text-lg" >
                            <tr class="h-2rem">
                                <th class="w-2">#{msg['report.md5hash']}</th>
                                <td>#{reportBean.selectedSample.reportValueDTO.hashMD5}</td>
                            </tr>
                            <tr class="h-2rem">
                                <th class="w-2">#{msg['report.sha1hash']}</th>
                                <td>#{reportBean.selectedSample.reportValueDTO.hashSHA1}</td>
                            </tr>
                            <tr class="h-2rem">
                                <th class="w-2">#{msg['report.sha256hash']}</th>
                                <td>#{reportBean.selectedSample.reportValueDTO.hashSHA256}</td>
                            </tr>
                            <tr class="h-2rem">
                                <th class="w-2">#{msg['report.ssdeep']}</th>
                                <td>#{reportBean.selectedSample.reportValueDTO.hashSSDEEP}</td>
                            </tr>
                            <tr class="h-2rem">
                                <th class="w-2">#{msg['report.fileSize']}</th>
                                <td>#{reportBean.selectedSample.reportValueDTO.fileSizeInBytes/1000} KB</td>
                            </tr>
                            <tr class="h-2rem">
                                <th class="w-2">#{msg['report.fileType']}</th>
                                <td>#{reportBean.selectedSample.reportValueDTO.fileType}</td>
                            </tr>
                        </table>
                            <p:divider/>

                            <h5>#{msg['report.otherDetail']}</h5>
                            <table width="100%" class="text-left text-lg" >
                            <tr class="h-2rem">
                                <th class="w-2">#{msg['report.entropyValue']}</th>
                                <td>#{reportBean.selectedSample.reportValueDTO.entropyValue}</td>
                            </tr>
                              <tr class="h-2rem">
                                <th class="w-2">#{msg['report.packer']}</th>
                                <td>#{reportBean.selectedSample.reportValueDTO.packer}</td>
                            </tr>
                                 <tr class="h-2rem">
                                <th class="w-2">#{msg['report.entropyStatus']}</th>
                                <td>#{reportBean.selectedSample.reportValueDTO.entropyStatus}</td>
                            </tr>
                                 <tr class="h-2rem">
                                <th class="w-2">#{msg['report.compiler']}</th>
                                <td>#{reportBean.selectedSample.reportValueDTO.compiler}</td>
                            </tr>
                            </table>
                            <p:divider/>
                            <h5>#{msg['report.identifiedProperties']}</h5>
                            <p:accordionPanel widgetVar="basic" activeIndex="null" multiple="true" >
                                <p:tab title="#{msg['report.strings']}">
                                    <p:repeat value="#{reportBean.selectedSample.reportValueDTO.fileString}" var="string">
                                        <h:outputText value="#{string}"/><br/>
                                    </p:repeat>

                                </p:tab>
                                <p:tab title="#{msg['report.imports']}">
                                    <p:repeat value="#{reportBean.selectedSample.reportValueDTO.importLibrary}" var="importLibrary">
                                        <h:outputText value="#{importLibrary}"/><br/>
                                    </p:repeat>
                                </p:tab>
                            </p:accordionPanel>
                    </div>
                    <br/>
                </h:form>
            </h:body>
        </ui:define>
    </ui:composition>
</html>
