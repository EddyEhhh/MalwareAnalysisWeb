<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xml:lang="en">

    <ui:composition template="/template/user_default.xhtml">
        <ui:define name="pageTitle">#{msg["header.upload"]}</ui:define>
        <ui:define name="body">
            <h:body >
                <div class="card" align="center">
                    <br><h4 class="px-4 pt-3 w-10">#{msg["upload.analysis"]}</h4></br>

                    <p class="line-height-3 font-semibold text-1xl w-4 text-justify">
                        #{msg['upload.tnc']}<br/><br/>
                        #{msg['upload.tnc2']}
                    </p><br/>                      

                    <h:form enctype="multipart/form-data" >
                        <p:commandButton value="#{msg['upload.uploadFile']}" class="ui-button-help" icon="pi pi-upload" onclick="PF('uploadFormDialog').show()" disabled="#{fileUploadBean.disabledUploadFile}"/>
                        <p:dialog header="#{msg['upload.analysis']}" widgetVar="uploadFormDialog" minHeight="40" width="400" showEffect="fade" modal="true" minimizable="true" style="text-align:left" responsive="true">
                             <p:outputPanel id="uploadFilePanel" class="ui-fluid">

                            <!-- File Upload Section -->
                            <p:outputLabel class="text-lg font-bold">#{msg["upload.file"]}</p:outputLabel><br/><br/>
                            <p:fileUpload value="#{fileUploadBean.file}" mode="simple" required="true" id="fileUpload"
                                           sizeLimit="16000000" fileLimit="1" />                       
                            <p:message for="fileUpload"/>
                            <br/><br/>

                            <p:outputLabel  class="text-lg font-bold" value="#{msg['upload.environment']}"/> <br/><br/>
                            <p:selectOneMenu id="selectEnvironment" value="#{fileUploadBean.sampleDTO.analysisEnvironment}"
                                             required="true">
                                <f:selectItem itemLabel="#{msg['upload.win7']}" itemValue="Windows 7"/>
                                <f:selectItem itemLabel="#{msg['upload.win10']}" itemValue="Windows 10"/>
                                <f:selectItem itemLabel="#{msg['upload.linux']}" itemValue="Linux"/>
                                <f:selectItem itemLabel="#{msg['upload.android']}" itemValue="Android"/>
                                <f:selectItem itemLabel="#{msg['upload.macos']}" itemValue="macOS"/>
                            </p:selectOneMenu>
                            <br/>
<!--
                            <p:outputLabel class="text-lg font-bold" value="#{msg['upload.notificationSetting']}"/> <br/><br/>
                            <p:selectBooleanCheckbox itemLabel="#{msg['upload.notification']}"  
                                                     value="#{fileUploadBean.notification}"/>-->
                          
                            <p:growl globalOnly="true" id="uploadFileMessage" showDetail="true"/>
                            <div id="loadingText" style="font-weight:bold; margin:5px 0 5px 0; visibility:hidden;">
                                <i class="pi pi-spin pi-spinner" style="font-size: 1rem"></i> Uploading File...
                            </div>
                             </p:outputPanel>

                            <!-- Button for upload and Cancel -->
                            <f:facet name="footer">
                                 <p:commandButton value="#{msg['general.cancel']}" icon="pi pi-times" 
                                                 class="ui-button-raised ui-button-secondary ui-button-flat" onclick="PF('uploadFormDialog').hide()"/>
                                <p:commandButton value="#{msg['header.upload']}" icon="pi pi-upload" class="ui-button-raised ui-button-help" action="#{fileUploadBean.upload}"
                                                 update="uploadFilePanel"
                                                 oncomplete="$('#loadingText').css('visibility', 'hidden')" onclick="$('#loadingText').css('visibility', 'visible'), PF('uploadFormDialog').hide()"/>
                            </f:facet>
                        </p:dialog>
                    </h:form>
                </div>
            </h:body>
        </ui:define>
    </ui:composition>
</html>

