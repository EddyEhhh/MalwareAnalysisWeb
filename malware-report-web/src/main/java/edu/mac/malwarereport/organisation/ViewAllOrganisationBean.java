/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/Classes/Class.java to edit this template
 */
package edu.mac.malwarereport.organisation;

import edu.mac.malwarereport.organisation.applicationFacade.OrganisationAccountApplicationFacade;
import edu.mac.malwarereport.organisation.dto.OrganisationDTO;
import jakarta.annotation.PostConstruct;
import jakarta.enterprise.context.RequestScoped;
import jakarta.inject.Inject;
import jakarta.inject.Named;
import java.io.Serializable;
import java.util.Collections;
import java.util.List;
import java.util.Locale;
import org.apache.commons.lang3.StringUtils;

/**
 *
 * @author tohyu
 */
@Named("viewAllOrganisation")
@RequestScoped
public class ViewAllOrganisationBean implements Serializable {

    private List<OrganisationDTO> organisation;
    
    private List<OrganisationDTO> filteredOrganisation;
    
    private OrganisationDTO selectedOrganisation;
    
    @Inject
    private OrganisationAccountApplicationFacade organisationAccountApplicationFacade;
    
    @PostConstruct
    public void init(){
        organisation = organisationAccountApplicationFacade.findAll();
        Collections.reverse(organisation);
        
    }
    
    public boolean globalFilterFunction(Object value, Object filter, Locale locale) {
        String filterText = (filter == null) ? null : filter.toString().trim().toLowerCase();
        if (StringUtils.isBlank(filterText)) {
            return true;
        }
        
         int filterInt = getInteger(filterText);
        
        OrganisationDTO organisation = (OrganisationDTO) value;
        return organisation.getName().toLowerCase().contains(filterText)
                || organisation.getSettingDTO().getMaxMember() == filterInt
                || organisation.getNumberOfMember() == filterInt
                || organisation.getSettingDTO().getMaxScan() == filterInt;
    }
    
     private int getInteger(String filterText) {
        try {
            return Integer.parseInt(filterText);
        }
        catch (NumberFormatException ex) {
            return 0;
        }
    }
    
//    public void deleteOrganisation(){
//        UUID id = selectedOrganisation.getId(); 
//        organisationManager.deleteOrganisation(id);
//    }
//    
    /**
     * @return the organisation
     */
    public List<OrganisationDTO> getOrganisation() {
        return organisation;
    }

    /**
     * @param organisation the organisation to set
     */
    public void setOrganisation(List<OrganisationDTO> organisation) {
        this.organisation = organisation;
    }

    /**
     * @return the filteredOrganisation
     */
    public List<OrganisationDTO> getFilteredOrganisation() {
        return filteredOrganisation;
    }

    /**
     * @param filteredOrganisation the filteredOrganisation to set
     */
    public void setFilteredOrganisation(List<OrganisationDTO> filteredOrganisation) {
        this.filteredOrganisation = filteredOrganisation;
    }

    /**
     * @return the selectedOrganisation
     */
    public OrganisationDTO getSelectedOrganisation() {
        return selectedOrganisation;
    }

    /**
     * @param selectedOrganisation the selectedOrganisation to set
     */
    public void setSelectedOrganisation(OrganisationDTO selectedOrganisation) {
        this.selectedOrganisation = selectedOrganisation;
    }
    
}
