/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/Classes/Class.java to edit this template
 */
package edu.mac.malwarereport.organisation;

import edu.mac.malwarereport.organisation.applicationFacade.OrganisationApplicationFacade;
import edu.mac.malwarereport.organisation.dto.OrganisationDTO;
import jakarta.faces.application.FacesMessage;
import jakarta.faces.context.FacesContext;
import jakarta.faces.view.ViewScoped;
import jakarta.inject.Inject;
import jakarta.inject.Named;
import java.io.Serializable;
import org.primefaces.PrimeFaces;

/**
 *
 * @author tohyu
 */
@Named("deleteOrganisation")
@ViewScoped
public class DeleteOrganisation implements Serializable{
    
    @Inject 
    private OrganisationApplicationFacade organisationApplicationFacade;
    
    private OrganisationDTO selectedOrganisation = new OrganisationDTO();
    
    @Inject
    private FacesContext facesContext;
    
    private PrimeFaces primeFaces = PrimeFaces.current();

    
    public void delete(){
        System.out.print("SELECTED: " + selectedOrganisation.getName());
        switch(organisationApplicationFacade.deleteOrganisation(selectedOrganisation)){
            case SUCCESS:
                facesContext.addMessage(null, new FacesMessage(FacesMessage.SEVERITY_INFO, "Delete Successfully", null));
                primeFaces.ajax().update("organisationForm"); 
                break;
            case ERROR:
            default:
                facesContext.addMessage(null, new FacesMessage(FacesMessage.SEVERITY_ERROR, "Oops something went wrong", null));
                break;
            }
        }
    
    public void openDeleteDialog(OrganisationDTO organisationDTO){
        selectedOrganisation = organisationDTO;
        primeFaces.executeScript("PF('deleteOrgDialog').show();");
        //FacesContext.getCurrentInstance().getPartialViewContext().getRenderIds().add("deleteRoleForm:deleteRoleDialog");
    }
    
       /**
     * @return the selectedOrganisation
     */
    public OrganisationDTO getSelectedOrganisation() {
        return selectedOrganisation;
    }

    /**
     * @param selectedOrganisation the selectedOrganisation to set
     */
    public void setSelectedOrganisation(OrganisationDTO selectedOrganisation) {
        this.selectedOrganisation = selectedOrganisation;
    }
    
    
    
}
