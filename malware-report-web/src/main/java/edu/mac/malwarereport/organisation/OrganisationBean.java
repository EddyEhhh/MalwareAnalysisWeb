/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/Classes/Class.java to edit this template
 */
package edu.mac.malwarereport.organisation;

import edu.mac.malwarereport.organisation.applicationFacade.OrganisationApplicationFacade;
import edu.mac.malwarereport.organisation.dto.OrganisationDTO;
import jakarta.annotation.PostConstruct;
import jakarta.enterprise.context.RequestScoped;
import jakarta.faces.context.FacesContext;
import jakarta.inject.Inject;
import jakarta.inject.Named;
import jakarta.servlet.http.HttpServletRequest;

/**
 *
 * @author tohyu
 */
@Named("organisationBean")
@RequestScoped 
public class OrganisationBean{
    
    private OrganisationDTO selectedOrganisation;
    
    private String disabledCreateMember;
    
    private int numberOfScan;
    
    @Inject
    private OrganisationApplicationFacade organisationApplicationFacade;
        
    @PostConstruct
    public void init(){
        HttpServletRequest req = (HttpServletRequest)FacesContext.getCurrentInstance().getExternalContext().getRequest();
        //this is to request the 'id' which is the variable at the end on the url 
        String suuid = req.getParameter("id");
        //find the report by the 'id'
        selectedOrganisation = organisationApplicationFacade.findBySuuid(suuid);
        
        
        disableCreateMember(selectedOrganisation);
    }
    
    public void disableCreateMember(OrganisationDTO selectedOrganisation){
        if (selectedOrganisation.getNumberOfMember() >= selectedOrganisation.getSettingDTO().getMaxMember()){
            disabledCreateMember = "true";
        }
        else{
            disabledCreateMember = "false";
        }
    
}
    
    /**
     * @return the selectedOrganisation
     */
    public OrganisationDTO getSelectedOrganisation() {
        return selectedOrganisation;
    }

    /**
     * @param selectedOrganisation the selectedOrganisation to set
     */
    public void setSelectedOrganisation(OrganisationDTO selectedOrganisation) {
        this.selectedOrganisation = selectedOrganisation;
    }
    
       /**
     * @return the disabledCreateMember
     */
    public String getDisabledCreateMember() {
        return disabledCreateMember;
    }

    /**
     * @param disabledCreateMember the disabledCreateMember to set
     */
    public void setDisabledCreateMember(String disabledCreateMember) {
        this.disabledCreateMember = disabledCreateMember;
    }
    
        /**
     * @return the numberOfScan
     */
    public int getNumberOfScan() {
        return numberOfScan;
    }

    /**
     * @param numberOfScan the numberOfScan to set
     */
    public void setNumberOfScan(int numberOfScan) {
        this.numberOfScan = numberOfScan;
    }
}
