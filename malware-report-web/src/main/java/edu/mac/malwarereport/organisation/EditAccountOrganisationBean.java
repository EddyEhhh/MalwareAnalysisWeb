/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/Classes/Class.java to edit this template
 */
package edu.mac.malwarereport.organisation;

import edu.mac.malwarereport.account.applicationFacade.AccountOrganisationApplicationFacade;
import edu.mac.malwarereport.account.web.RedirectBean;
import edu.mac.malwarereport.organisation.dto.OrganisationDTO;
import jakarta.annotation.PostConstruct;
import jakarta.enterprise.context.RequestScoped;
import jakarta.faces.application.FacesMessage;
import jakarta.faces.context.FacesContext;
import jakarta.faces.context.Flash;
import jakarta.inject.Inject;
import jakarta.inject.Named;

/**
 *
 * @author tohyu
 */
@Named("editAccountOrganisationBean")
@RequestScoped
public class EditAccountOrganisationBean {
    
    @Inject
    private AccountOrganisationApplicationFacade accountOrganisationApplicationFacade;
     
    @Inject
    private FacesContext facesContext; 
    
    @Inject
    private RedirectBean redirectBean;
     
     private OrganisationDTO organisation;
     
     @PostConstruct
     public void init(){
         organisation = accountOrganisationApplicationFacade.getCurrentOrganisation();
     }
     
     public void editOrganisation() throws Exception{
         String uid = organisation.getSuuid();
        facesContext = FacesContext.getCurrentInstance();
        Flash flash = facesContext.getExternalContext().getFlash();
        flash.setKeepMessages(true);
         switch(accountOrganisationApplicationFacade.updateOrganisation(organisation)){
             case SUCCESS:
                facesContext.addMessage(null, new FacesMessage(FacesMessage.SEVERITY_INFO, "Details updated successfully", null));
                redirectBean.viewOrganisationDetail();
                break;
            case ERROR:
            default:
                facesContext.addMessage(null, new FacesMessage(FacesMessage.SEVERITY_ERROR, "Oops something went wrong!", null));
                break;
         }
     }
     
     
       /**
     * @return the organisation
     */
    public OrganisationDTO getOrganisation() {
        return organisation;
    }

    /**
     * @param organisation the organisation to set
     */
    public void setOrganisation(OrganisationDTO organisation) {
        this.organisation = organisation;
    }
     
    
}
