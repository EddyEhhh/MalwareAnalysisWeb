/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/Classes/Class.java to edit this template
 */
package edu.mac.malwarereport.account;

import edu.mac.malwarereport.account.applicationFacade.AccountApplicationFacade;
import edu.mac.malwarereport.account.applicationFacade.ReadAccountApplicationFacade;
import edu.mac.malwarereport.account.dto.AccountDTO;
import edu.mac.malwarereport.account.manager.AccountManager;
import static edu.mac.malwarereport.account.outputInfo.OutcomeStatus.ERROR;
import static edu.mac.malwarereport.account.outputInfo.OutcomeStatus.SUCCESS;
import edu.mac.malwarereport.account.web.RedirectBean;
import jakarta.annotation.PostConstruct;
import jakarta.enterprise.context.RequestScoped;
import jakarta.faces.application.FacesMessage;
import jakarta.faces.context.FacesContext;
import jakarta.inject.Inject;
import jakarta.inject.Named;

/**
 *
 * @author Jaibun Thana
 */

@RequestScoped
@Named("editAccountBean")
public class EditAccountBean {
    
    @Inject
    private AccountApplicationFacade accountApplicationFacade;
    
    @Inject
    private ReadAccountApplicationFacade readAccountApplicationFacade;
    
     @Inject
    private RedirectBean redirectBean;
     
     @Inject
     private AccountManager accountManager;
    
    @Inject
    private FacesContext facesContext; 
    
    private AccountDTO accountDTO = new AccountDTO();
    
    @PostConstruct
    public void init(){
        accountDTO = readAccountApplicationFacade.getCurrentAccount();
    }
    
    public void updateAccount() throws Exception{
        switch(accountManager.updateAccount(accountDTO)){
             case SUCCESS:
                facesContext.addMessage(null, new FacesMessage(FacesMessage.SEVERITY_INFO, "Details updated successfully", null));
                redirectBean.viewProfile();
                break;
            case ERROR:
            default:
                facesContext.addMessage(null, new FacesMessage(FacesMessage.SEVERITY_ERROR, "Oops something went wrong!", null));
                break;
        }
    }
    
    /**
     * @return the accountDTO
     */
    public AccountDTO getAccountDTO() {
        return accountDTO;
    }

    /**
     * @param accountDTO the accountDTO to set
     */
    public void setAccountDTO(AccountDTO accountDTO) {
        this.accountDTO = accountDTO;
    }
    
    
}
