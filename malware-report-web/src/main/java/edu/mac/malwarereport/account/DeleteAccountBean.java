/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/Classes/Class.java to edit this template
 */
package edu.mac.malwarereport.account;

import edu.mac.malwarereport.account.applicationFacade.AccountApplicationFacade;
import edu.mac.malwarereport.account.dto.AccountDTO;
import static edu.mac.malwarereport.account.outputInfo.OutcomeStatus.ERROR;
import static edu.mac.malwarereport.account.outputInfo.OutcomeStatus.SUCCESS;
import edu.mac.malwarereport.account.web.RedirectBean;
import jakarta.faces.application.FacesMessage;
import jakarta.faces.context.FacesContext;
import jakarta.faces.view.ViewScoped;
import jakarta.inject.Inject;
import jakarta.inject.Named;
import java.io.Serializable;
import org.primefaces.PrimeFaces;

/**
 *
 * @author Jaibun Thana
 */
@Named("deleteAccountBean")
@ViewScoped
public class DeleteAccountBean implements Serializable{
    
    @Inject
    private AccountApplicationFacade accountApplicationFacade;
    
    @Inject
    private RedirectBean redirectBean;
    
    @Inject
    private FacesContext facesContext;
    
    private PrimeFaces primeFaces = PrimeFaces.current();

    
    private AccountDTO selectedAccountDTO;
    
    public void openDeleteDialog(AccountDTO accountDTO){
        setSelectedAccountDTO(accountDTO);
        primeFaces.executeScript("PF('deleteMemberDialog').show();");
        //FacesContext.getCurrentInstance().getPartialViewContext().getRenderIds().add("deleteRoleForm:deleteRoleDialog");
    }
    
    public void delete() throws Exception{
        System.out.print("WEB DELETE");
        switch(accountApplicationFacade.delete(selectedAccountDTO)){
            case SUCCESS:
                facesContext.addMessage(null, new FacesMessage(FacesMessage.SEVERITY_INFO, "Member sucessfully removed", null));
                primeFaces.ajax().update("memberForm");
                break;
            case ERROR:
                facesContext.addMessage(null, new FacesMessage(FacesMessage.SEVERITY_ERROR, "Error: Oops something went wrong!", null));
                break;
            default:
                facesContext.addMessage(null, new FacesMessage(FacesMessage.SEVERITY_ERROR, "Oops something went wrong!", null));
                break;
        }
    }

    /**
     * @return the selectedAccountDTO
     */
    public AccountDTO getSelectedAccountDTO() {
        return selectedAccountDTO;
    }

    /**
     * @param selectedAccountDTO the selectedAccountDTO to set
     */
    public void setSelectedAccountDTO(AccountDTO selectedAccountDTO) {
        this.selectedAccountDTO = selectedAccountDTO;
    }
}
