/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/Classes/Class.java to edit this template
 */
package edu.mac.malwarereport.account;

import edu.mac.malwarereport.account.applicationFacade.AccountOrganisationApplicationFacade;
import edu.mac.malwarereport.account.applicationFacade.ReadAccountApplicationFacade;
import edu.mac.malwarereport.account.dto.AccountDTO;
import edu.mac.malwarereport.organisation.dto.OrganisationDTO;
import jakarta.annotation.PostConstruct;
import jakarta.enterprise.context.RequestScoped;
import jakarta.inject.Inject;
import jakarta.inject.Named;
import java.io.Serializable;
import java.util.Collections;
import java.util.HashMap;
import java.util.List;
import java.util.Locale;
import java.util.Map;
import org.apache.commons.lang3.StringUtils;

/**
 *
 * @author tohyu
 */
@Named("viewAllAccountBean")
@RequestScoped
//view all the members part of the organisation
public class ViewAllAccountBean implements Serializable{

    private List<AccountDTO> accounts;
    
    private Map<AccountDTO,OrganisationDTO> accountInformations = new HashMap<AccountDTO,OrganisationDTO>();
        
    private List<AccountDTO> filteredAccount;
    
    @Inject
    private ReadAccountApplicationFacade readAccountApplicationFacade;
    
    @Inject
    private AccountOrganisationApplicationFacade accountOrganisationApplicationFacade;
    
    @PostConstruct
    public void init(){
        setAccounts(readAccountApplicationFacade.findAll());
//        for(AccountDTO eachAccount : accounts){
//            OrganisationDTO organisationDTO = accountOrganisationApplicationFacade.getOrganisation(eachAccount);
//            accountInformations.put(eachAccount, organisationDTO);
//        }
//        
        Collections.reverse(getAccounts());
    }
    
    public boolean globalFilterFunction(Object value, Object filter, Locale locale) {
        String filterText = (filter == null) ? null : filter.toString().trim().toLowerCase();
        if (StringUtils.isBlank(filterText)) {
            return true;
        }

        AccountDTO account = (AccountDTO) value;
        return account.getFirstName().toLowerCase().contains(filterText)
                || account.getLastName().toLowerCase().contains(filterText)
                || account.getEmail().toLowerCase().contains(filterText);
    }
    

    
    
    /**
     * @return the filteredAccounts
     */
    public List<AccountDTO> getFilteredAccount() {
        return filteredAccount;
    }

    /**
     * @param filteredAccount the filteredAccount to set
     */
    public void setFilteredAccount(List<AccountDTO> filteredAccount) {
        this.filteredAccount = filteredAccount;
    }

    /**
     * @return the accountInformations
     */
    public Map<AccountDTO,OrganisationDTO> getAccountInformations() {
        return accountInformations;
    }

    /**
     * @param accountInformations the accountInformations to set
     */
    public void setAccountInformations(Map<AccountDTO,OrganisationDTO> accountInformations) {
        this.accountInformations = accountInformations;
    }

    /**
     * @return the accounts
     */
    public List<AccountDTO> getAccounts() {
        return accounts;
    }

    /**
     * @param accounts the accounts to set
     */
    public void setAccounts(List<AccountDTO> accounts) {
        this.accounts = accounts;
    }
    
    
}
