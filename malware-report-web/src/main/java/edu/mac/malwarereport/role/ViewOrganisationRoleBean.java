/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/Classes/Class.java to edit this template
 */
package edu.mac.malwarereport.role;

import edu.mac.malwarereport.account.applicationFacade.SubjectRoleApplicationFacade;
import edu.mac.malwarereport.role.applicationFacade.RoleOrganisationApplicationFacade;
import edu.mac.malwarereport.role.dto.RoleDTO;
import jakarta.annotation.PostConstruct;
import jakarta.enterprise.context.RequestScoped;
import jakarta.inject.Inject;
import jakarta.inject.Named;
import java.io.Serializable;
import java.util.Collections;
import java.util.List;
import java.util.Locale;
import org.apache.commons.lang3.StringUtils;

/**
 *
 * @author tohyu
 */
@Named("viewOrganisationRoleBean")
@RequestScoped
public class ViewOrganisationRoleBean implements Serializable{
    
    private List<RoleDTO> roles;
    
    private List<RoleDTO> filteredRoles;
    
    @Inject
    private RoleOrganisationApplicationFacade RoleOrganisationApplicationFacade;
    
    @Inject
    private SubjectRoleApplicationFacade subjectRoleApplicationFacade;
    
    @PostConstruct
    public void init(){
        roles = RoleOrganisationApplicationFacade.getRoleList();
        Collections.reverse(roles);
    }
    
    public int numberOfMemberInRole(String suuid){
        RoleDTO tempRole = new RoleDTO();
        tempRole.setSuuid(suuid);
        return subjectRoleApplicationFacade.getAllAccountByRole(tempRole).size();
    }
    
    public boolean globalFilterFunction(Object value, Object filter, Locale locale) {
        String filterText = (filter == null) ? null : filter.toString().trim().toLowerCase();
        if (StringUtils.isBlank(filterText)) {
            return true;
        }
        
        RoleDTO role = (RoleDTO) value;
        return role.getName().toLowerCase().contains(filterText) ||
                role.getDescription().toLowerCase().contains(filterText);
    }
    
    /**
     * @return the roles
     */
    public List<RoleDTO> getRoles() {
        return roles;
    }

    /**
     * @param roles the roles to set
     */
    public void setRoles(List<RoleDTO> roles) {
        this.roles = roles;
    }

    /**
     * @return the filteredRoles
     */
    public List<RoleDTO> getFilteredRoles() {
        return filteredRoles;
    }

    /**
     * @param filteredRoles the filteredRoles to set
     */
    public void setFilteredRoles(List<RoleDTO> filteredRoles) {
        this.filteredRoles = filteredRoles;
    }
    
    
}
