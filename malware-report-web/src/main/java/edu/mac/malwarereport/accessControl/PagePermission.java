/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/Classes/Class.java to edit this template
 */
package edu.mac.malwarereport.accessControl;

import edu.mac.malwarereport.account.applicationFacade.SubjectRoleApplicationFacade;
import edu.mac.malwarereport.account.web.RedirectBean;
import edu.mac.malwarereport.permission.applicationFacade.PermissionApplicationFacade;
import jakarta.enterprise.context.RequestScoped;
import jakarta.inject.Inject;
import jakarta.inject.Named;

/**
 *
 * @author Jaibun Thana
 */
@RequestScoped
@Named
public class PagePermission {
    
    @Inject
    private SubjectRoleApplicationFacade subjectRoleApplicationFacade;
    
    @Inject
    private RedirectBean redirectBean;
    
    @Inject
    private PermissionApplicationFacade permissionApplicationFacade;
    
    public void redirectHome() throws Exception{
        
            if(subjectRoleApplicationFacade.isAdministrator()){
                redirectBean.adminDashboard();
            }else if(subjectRoleApplicationFacade.isManager()){
                redirectBean.organisationMember();
            }
            //Check permission to view reports and redirect to dashboard
            else if(permissionApplicationFacade.hasPermission("edu.mac.malwarereport.report.applicationFacade.ReportOrganisationApplicationFacade.getSampleList", "INTERNAL")){
                redirectBean.dashboard();
            //Check Permission to upload redirect to upload sample
            }else if(permissionApplicationFacade.hasPermission("edu.mac.malwarereport.report.applicationFacade.UploadFileApplicationFacade.isUploadFile", "INTERNAL")){
                redirectBean.uploadFile();
            }else{
                redirectBean.about();
            }
        
    }
    
}
