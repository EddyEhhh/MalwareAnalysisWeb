/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/Classes/Class.java to edit this template
 */
package edu.mac.malwarereport.account.resource;

import edu.mac.malwarereport.account.outputInfo.TimeoutStatus;
import jakarta.ejb.Stateless;
import jakarta.inject.Named;
import java.util.Calendar;
import java.util.Date;
import java.util.concurrent.TimeUnit;

/**
 *
 * @author Jaibun Thana
 */
@Stateless
@Named("dateChecker")
public class DateChecker {
    
    public boolean isWithinTimeout(Date date, int timeoutInSeconds){
        long timeDifference = getCurrentTime().getTime() - date.getTime();
        long timestampSeconds = TimeUnit.MILLISECONDS.toSeconds(timeDifference);
        if(timestampSeconds < timeoutInSeconds){ //Time difference below timeout.
            return true;
        }else{
            return false;
        }
    }
    
    //check the timeout for login attempts
    public boolean timer(Date date, int lockoutTime){
        long timeDifference = getCurrentTime().getTime() - date.getTime();
        long timestampSeconds = TimeUnit.MILLISECONDS.toSeconds(timeDifference);
        long timer = (60 * lockoutTime); //time in seconds 
        if (timestampSeconds > timer){
            return true;
        }
        else{
            return false;
        }
    }
    
    private Date getCurrentTime(){
        Calendar cal = Calendar.getInstance();
        Date date = cal.getTime();
        return date;
    }
}
