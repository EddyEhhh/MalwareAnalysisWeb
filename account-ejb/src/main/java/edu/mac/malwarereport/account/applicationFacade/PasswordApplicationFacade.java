/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/Classes/Class.java to edit this template
 */
package edu.mac.malwarereport.account.applicationFacade;

import edu.mac.malwarereport.accesscontrol.interceptor.IsPermittedInterceptor;
import edu.mac.malwarereport.account.manager.*;
import edu.mac.malwarereport.account.dto.AccountDTO;
import edu.mac.malwarereport.account.outputInfo.OutcomeStatus;
import edu.mac.malwarereport.account.outputInfo.ResetPasswordStatus;
import jakarta.ejb.Stateless;
import jakarta.inject.Inject;
import jakarta.interceptor.Interceptors;

/**
 *
 * @author Jaibun Thana
 */
@Stateless

public class PasswordApplicationFacade {

    @Inject
    private PasswordManager passwordManager;
    
    //Permission: no
    public OutcomeStatus createResetPasswordToken(AccountDTO accountDTO) {
        return passwordManager.createResetPasswordToken(accountDTO);
    }

    //Permission: no
    public ResetPasswordStatus resetPassword(AccountDTO accountDTO) {
        return passwordManager.resetPassword(accountDTO);
    }
        
    //Permission: SELF (Change password)
    @Interceptors({IsPermittedInterceptor.class})
    public String changePassword(AccountDTO accountDTO) {
        return passwordManager.changePassword(accountDTO);
    }
}
