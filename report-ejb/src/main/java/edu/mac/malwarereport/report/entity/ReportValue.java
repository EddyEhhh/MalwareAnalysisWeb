/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package edu.mac.malwarereport.report.entity;

import edu.mac.malwarereport.report.attributeConverter.StringListConverter;
import edu.mac.malwarereport.report.dto.ReportValueDTO;
import jakarta.persistence.Column;
import jakarta.persistence.Convert;
import jakarta.persistence.Entity;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.GenerationType;
import jakarta.persistence.Id;
import jakarta.persistence.PrePersist;
import jakarta.persistence.Table;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;

/**
 *
 * @author Jaibun Thana
 */
@Entity
@Table(name="reportValue")
public class ReportValue {

   
    @Id
    @Column(name="id")
    @GeneratedValue(strategy=GenerationType.AUTO)
    private Long id;
    
    @Column(name="sampleName")
    private String sampleName;
    
    //@Min(value = 0)
    //@Max(value = 5)
    @Column(name="threatScore")
    private int threatScore;
    
    //@NotBlank
    //@Pattern(regexp = "^[A-Fa-f0-9]{32}$", message = "Invalid MD5 Hash")
    @Column(name="hashMD5")
    private String hashMD5;
    
    //@NotBlank
    //@Pattern(regexp = "^[A-Fa-f0-9]{40}$", message = "Invalid SHA1 Hash")
    @Column(name="hashSHA1")
    private String hashSHA1;
    
    //@NotBlank
    //@Pattern(regexp = "^[A-Fa-f0-9]{64}$", message = "Invalid SHA256 Hash")
    @Column(name="hashSHA256")
    private String hashSHA256;
    
    //@NotBlank
    @Column(name="hashSSDEEP")
    private String hashSSDEEP;
    
    @Column(name="entropyValue")
    private double entropyValue;
    
    @Column(name="entropyStatus")
    private String entropyStatus;
        
    @Column(name="packer")
    private String packer;
    
    @Column(name="compiler")
    private String compiler;
    
    @Column(name="fileSizeInBytes")
    private int fileSizeInBytes;
    
    @Column(name="fileType")
    private String fileType;
    
    @Column(name="compileTimestamp")
    private Date compileTimestamp;

    @Column(name="importLibrary", columnDefinition = "TEXT")
    @Convert(converter = StringListConverter.class)
    private List<String> importLibrary;
    
    @Column(name="fileString", columnDefinition = "TEXT")
    @Convert(converter = StringListConverter.class)
    private List<String> fileString;
    
    @PrePersist
    public void onCreate(){
        List<String> temp = new ArrayList<>();
        temp.add("Null");
        temp.add("String");
        importLibrary = temp;
        fileString = temp;
    }
    
    public ReportValue(){}

    public ReportValue(String sampleName, int threatScore, String hashMD5, String hashSHA1, String hashSHA256, String hashSSDEEP, double entropyValue, String entropyStatus, String packer, String compiler, int fileSizeInBytes, String fileType, Date compileTimestamp, List importLibrary, List fileString) {
        this.sampleName = sampleName;
        this.threatScore = threatScore;
        this.hashMD5 = hashMD5;
        this.hashSHA1 = hashSHA1;
        this.hashSHA256 = hashSHA256;
        this.hashSSDEEP = hashSSDEEP;
        this.entropyValue = entropyValue;
        this.entropyStatus = entropyStatus;
        this.packer = packer;
        this.compiler = compiler;
        this.fileSizeInBytes = fileSizeInBytes;
        this.fileType = fileType;
        this.compileTimestamp = compileTimestamp;
        this.importLibrary = importLibrary;
        this.fileString = fileString;

    }
    
    public ReportValue(String sampleName) {
        this.sampleName = sampleName;
    }
    
    
    
    public ReportValueDTO toDTO(){
        ReportValueDTO reportValuedDTO = new ReportValueDTO(this.sampleName, this.threatScore, this.hashMD5, this.hashSHA1, this.hashSHA256, this.hashSSDEEP, this.entropyValue, this.entropyStatus, this.packer, this.compiler, this.fileSizeInBytes, this.fileType, this.compileTimestamp, this.importLibrary, this.fileString);
        return reportValuedDTO;
    }
    
    //Setters and Getters
    /**
     * @return the id
     */
    public Long getId() {
        return id;
    }

    /**
     * @param id the id to set
     */
    public void setId(Long id) {
        this.id = id;
    }

    /**
     * @return the malwareName
     */
    public String getSampleName() {
        return sampleName;
    }

    /**
     * @param malwareName the malwareName to set
     */
    public void setSampleName(String sampleName) {
        this.sampleName = sampleName;
    }

    /**
     * @return the threatScore
     */
    public int getThreatScore() {
        return threatScore;
    }

    /**
     * @param threatScore the threatScore to set
     */
    public void setThreatScore(int threatScore) {
        this.threatScore = threatScore;
    }

    /**
     * @return the hashMD5
     */
    public String getHashMD5() {
        return hashMD5;
    }

    /**
     * @param hashMD5 the hashMD5 to set
     */
    public void setHashMD5(String hashMD5) {
        this.hashMD5 = hashMD5;
    }

    /**
     * @return the hashSHA1
     */
    public String getHashSHA1() {
        return hashSHA1;
    }

    /**
     * @param hashSHA1 the hashSHA1 to set
     */
    public void setHashSHA1(String hashSHA1) {
        this.hashSHA1 = hashSHA1;
    }

    /**
     * @return the hashSHA256
     */
    public String getHashSHA256() {
        return hashSHA256;
    }

    /**
     * @param hashSHA256 the hashSHA256 to set
     */
    public void setHashSHA256(String hashSHA256) {
        this.hashSHA256 = hashSHA256;
    }

    /**
     * @return the hashSSDEEP
     */
    public String getHashSSDEEP() {
        return hashSSDEEP;
    }

    /**
     * @param hashSSDEEP the hashSSDEEP to set
     */
    public void setHashSSDEEP(String hashSSDEEP) {
        this.hashSSDEEP = hashSSDEEP;
    }

    /**
     * @return the entropyValue
     */
    public double getEntropyValue() {
        return entropyValue;
    }

    /**
     * @param entropyValue the entropyValue to set
     */
    public void setEntropyValue(double entropyValue) {
        this.entropyValue = entropyValue;
    }

    /**
     * @return the entropyStatus
     */
    public String getEntropyStatus() {
        return entropyStatus;
    }

    /**
     * @param entropyStatus the entropyStatus to set
     */
    public void setEntropyStatus(String entropyStatus) {
        this.entropyStatus = entropyStatus;
    }

    /**
     * @return the packer
     */
    public String getPacker() {
        return packer;
    }

    /**
     * @param packer the packer to set
     */
    public void setPacker(String packer) {
        this.packer = packer;
    }

    /**
     * @return the compiler
     */
    public String getCompiler() {
        return compiler;
    }

    /**
     * @param compiler the compiler to set
     */
    public void setCompiler(String compiler) {
        this.compiler = compiler;
    }

    /**
     * @return the fileSizeInBytes
     */
    public int getFileSizeInBytes() {
        return fileSizeInBytes;
    }

    /**
     * @param fileSizeInBytes the fileSizeInBytes to set
     */
    public void setFileSizeInBytes(int fileSizeInBytes) {
        this.fileSizeInBytes = fileSizeInBytes;
    }

    /**
     * @return the headerTimeStamp
     */
    public Date getCompileTimestamp() {
        return compileTimestamp;
    }

    /**
     * @param headerTimeStamp the headerTimeStamp to set
     */
    public void setCompileTimestamp(Date compileTimestamp) {
        this.compileTimestamp = compileTimestamp;
    }

    /**
     * @return the importLibrary
     */
    public List<String>  getImportLibrary() {
        return importLibrary;
    }

    /**
     * @param importLibrary the importLibrary to set
     */
    public void setImportLibrary(List<String> importLibrary) {
        this.importLibrary = importLibrary;
    }
    
    /**
     * @return the fileType
     */
    public String getFileType() {
        return fileType;
    }

    /**
     * @param fileType the fileType to set
     */
    public void setFileType(String fileType) {
        this.fileType = fileType;
    }
    
    

 

    /**
     * @return the fileString
     */
    public List<String> getFileString() {
        return fileString;
    }

    /**
     * @param fileString the fileString to set
     */
    public void setFileString(List<String> fileString) {
        this.fileString = fileString;
    }
    
    
    


}
