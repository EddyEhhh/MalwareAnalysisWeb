/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/Classes/Class.java to edit this template
 */
package edu.mac.malwarereport.report.entity;

import edu.mac.malwarereport.report.dto.SampleDTO;
import jakarta.persistence.CascadeType;
import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.FetchType;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.GenerationType;
import jakarta.persistence.Id;
import jakarta.persistence.JoinColumn;
import jakarta.persistence.NamedQueries;
import jakarta.persistence.NamedQuery;
import jakarta.persistence.OneToOne;
import jakarta.persistence.PrePersist;
import jakarta.persistence.Table;
import java.util.Calendar;
import java.util.Date;
import java.util.UUID;
import org.eclipse.persistence.annotations.CacheCoordinationType;
import org.hibernate.annotations.Cache;

/**
 *
 * @author Jaibun Thana
 */
@Entity
@Table(name="sample")
@NamedQueries(
    @NamedQuery(name = "Sample.bySuuid", query = "select a from Sample a where a.suuid = :suuid")
)
//@Cache(coordinationType=CacheCoordinationType.INVALIDATE_CHANGED_OBJECTS, usage = )
public class Sample {

    @Id
    @Column(name="id")
    @GeneratedValue(strategy=GenerationType.AUTO)
    private long id;
    
    @Column(name="analysisStartTime")
    private Date analysisStartTime;
   
    @Column(name="analysisEndTime")
    private Date analysisEndTime;
   
    @Column(name="analysisEnvironment")
    private String analysisEnvironment;
    
    @Column(name="timestamp")
    private Date timestamp;
    
    @Column(name="status")
    private String status;
    
    @Column(name="sampleFileLocation")
    private String sampleFileLocation;
    
    @Column(name="suuid", unique = true)
    private String suuid;
    
    @OneToOne(fetch = FetchType.EAGER, cascade = CascadeType.ALL)
    @JoinColumn(referencedColumnName = "id", name = "reportValue")
    private ReportValue reportValue;
    
    @OneToOne(fetch = FetchType.EAGER, cascade = CascadeType.ALL)
    @JoinColumn(referencedColumnName = "id", name = "report")
    private Report report;

    public Sample(){}
    
    @PrePersist
    public void onCreate(){
        this.suuid = UUID.randomUUID().toString();
        Calendar cal = Calendar.getInstance();
        Date date = cal.getTime();
        timestamp = date;
    }
    
    public Sample(String analysisEnvironment, String status, String sampleFileLocation, ReportValue reportValue, Report report) {
        this.analysisEnvironment = analysisEnvironment;
        this.sampleFileLocation = sampleFileLocation;
        this.reportValue = reportValue;
        this.report = report;
        this.status = status;
    }
    
    public Sample(String analysisEnvironment, Date timestamp, String status, ReportValue reportValue, Report report) {
        this.analysisEnvironment = analysisEnvironment;
        this.reportValue = reportValue;
        this.report = report;
        this.timestamp = timestamp;
        this.status = status;
    }
    
    public SampleDTO toDTO(){
        SampleDTO sampleDTO = new SampleDTO(this.suuid, this.analysisStartTime, this.analysisEndTime, this.analysisEnvironment, this.timestamp, this.status, this.reportValue.toDTO(), this.report.toDTO());
        return sampleDTO;
    }
    
    
    
    /**
     * @return the id
     */
    public long getId() {
        return id;
    }

    /**
     * @param id the id to set
     */
    public void setId(long id) {
        this.id = id;
    }

    /**
     * @return the analysisStartTime
     */
    public Date getAnalysisStartTime() {
        return analysisStartTime;
    }

    /**
     * @param analysisStartTime the analysisStartTime to set
     */
    public void setAnalysisStartTime(Date analysisStartTime) {
        this.analysisStartTime = analysisStartTime;
    }

    /**
     * @return the analysisEndTime
     */
    public Date getAnalysisEndTime() {
        return analysisEndTime;
    }

    /**
     * @param analysisEndTime the analysisEndTime to set
     */
    public void setAnalysisEndTime(Date analysisEndTime) {
        this.analysisEndTime = analysisEndTime;
    }

    /**
     * @return the analysisEnvironment
     */
    public String getAnalysisEnvironment() {
        return analysisEnvironment;
    }

    /**
     * @param analysisEnvironment the analysisEnvironment to set
     */
    public void setAnalysisEnvironment(String analysisEnvironment) {
        this.analysisEnvironment = analysisEnvironment;
    }

    /**
     * @return the reportValue
     */
    public ReportValue getReportValue() {
        return reportValue;
    }

    /**
     * @param reportValue the reportValue to set
     */
    public void setReportValue(ReportValue reportValue) {
        this.reportValue = reportValue;
    }

    /**
     * @return the report
     */
    public Report getReport() {
        return report;
    }

    /**
     * @param report the report to set
     */
    public void setReport(Report report) {
        this.report = report;
    }
    
        /**
     * @return the suuid
     */
    public String getSuuid() {
        return suuid;
    }

    /**
     * @param suuid the suuid to set
     */
    public void setSuuid(String suuid) {
        this.suuid = suuid;
    }
    
    /**
     * @return the timestamp
     */
    public Date getTimestamp() {
        return timestamp;
    }

    /**
     * @param timestamp the timestamp to set
     */
    public void setTimestamp(Date timestamp) {
        this.timestamp = timestamp;
    }

    /**
     * @return the status
     */
    public String getStatus() {
        return status;
    }

    /**
     * @param status the status to set
     */
    public void setStatus(String status) {
        this.status = status;
    }

    /**
     * @return the sampleFileLocation
     */
    public String getSampleFileLocation() {
        return sampleFileLocation;
    }

    /**
     * @param sampleFileLocation the sampleFileLocation to set
     */
    public void setSampleFileLocation(String sampleFileLocation) {
        this.sampleFileLocation = sampleFileLocation;
    }
    
}
